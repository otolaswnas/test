(
  # 2 = krytyczny: etcd lub kube-apiserver niedostępne
  (min(cluster_operator_conditions{condition="Available",name=~"etcd|kube-apiserver"}) == 0) * 2
)
+
(
  # 1 = anomalie: są zdegradowane operatory, ale krytyczne działają
  (min(cluster_operator_conditions{condition="Available",name=~"etcd|kube-apiserver"}) == 1)
  * clamp_max(sum(cluster_operator_conditions{condition="Degraded"} == 1), 1)
)
or vector(3)  # 3 = brak danych




(
  # 2 = krytyczny: etcd lub kube-apiserver niedostępne
  (min(cluster_operator_conditions{condition="Available",name=~"etcd|kube-apiserver"}) == 0) * 2
)
+
(
  # 1 = anomalie: są zdegradowane operatory, ale krytyczne działają
  (min(cluster_operator_conditions{condition="Available",name=~"etcd|kube-apiserver"}) == 1)
  * clamp_max(sum(cluster_operator_conditions{condition="Degraded"} == 1), 1)
)
or vector(3)  # 3 = brak danych
